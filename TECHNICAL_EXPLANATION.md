# ุงูุฏููู ุงูููู ุงูุดุงูู ูุงูููุตู ููุดุฑูุน (ุงูููููู ุงููุฑุขูู) ๐ค

ูุฐุง ุงููุณุชูุฏ ุตููู ุฎุตูุตุงู ููููู ูุฑุฌุนู ุงููุงูู ูู ุงูููุงุจูุฉ ุงูุดุฎุตูุฉ. ูุดุฑุญ ูู ุณุทุฑ ุจุฑูุฌูุ ูู ุฎูุงุฑุฒููุฉุ ููู ูุฑุงุฑ ุชููู ุชู ุงุชุฎุงุฐู ูู ุงููุดุฑูุน ุจู "ูู ุตุบูุฑุฉ ููุจูุฑุฉ".

---

## 1. ุงูุจููุฉ ุงูุชุญุชูุฉ ูุงูุชูููุงุช (The Tech Stack)

ุงููุดุฑูุน ูุจูู ุจุงุณุชุฎุฏุงู ููุฏุณุฉ **Full-Stack JavaScript**:

*   **Frontend**: React.js (ุจูุงุณุทุฉ Vite) - ูุถูุงู ูุงุฌูุฉ ุณุฑูุนุฉ ูุฎูููุฉ.
*   **Backend**: Node.js & Express - ููุนุงูุฌุฉ ุงูุทูุจุงุช ูุงูุชุญูู ูู ููุทู ุงููุนุจุฉ.
*   **Database**: (In-Memory Session Store) - ูุณุชุฎุฏู ุงูุฐุงูุฑุฉ ุงูุญุงููุฉ ููุณูุฑูุฑ (Map) ูุชุฎุฒูู ุฌูุณุงุช ุงููุนุจ ุจุดูู ูุคูุช ูุณุฑูุน ุฌุฏุงู.
*   **AI Models**: 
    1.  **GPT-4o (ุนุจุฑ OpenRouter)**: ูุชูููุฏ ุงูุฃุณุฆูุฉ ูุชุญููู ุงูุฃุฏุงุก.
    2.  **Whisper-large-v3 (ุนุจุฑ Groq)**: ูุชุญููู ุงูููุงู ุฅูู ูุต (ุฃุณุฑุน STT ุญุงููุงู).
    3.  **ElevenLabs API**: ูุชูููุฏ ุฃุตูุงุช ุจุดุฑูุฉ ุทุจูุนูุฉ ููุชุนููู ุงูุตูุชู.

---

## 2. ุชูุงุตูู ุงูุฌุฒุก ุงูุฎููู (Deep Backend Logic)

### ุฃ- ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ููุณุงุฑุงุช ุงูู API (`server.js`)
*   **Multer**: ูุณุชุฎุฏู ููุชุจุฉ `multer` ุจุงุณุชุฑุงุชูุฌูุฉ `memoryStorage`. ุนูุฏูุง ุชุฑุณู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ููู ุงูุตูุชุ ูุง ูุญูุธู ููุฑุงู ุนูู ุงููุฑุต ุจู ูุฃุฎุฐู ูู `buffer` ูู ุงูุฐุงูุฑุฉ ุฃููุงู ูุฒูุงุฏุฉ ุงูุณุฑุนุฉ.
*   **Temporary File Handling**: ูุชู ุญูุธ ููู ุงูุตูุช ูุคูุชุงู ุจุงุณู ูุฑูุฏ (ุจูุงุณุทุฉ `Date.now() + Math.random()`) ูุถูุงู ุนุฏู ุชุฏุงุฎู ุทูุจุงุช ุงููุณุชุฎุฏูููุ ุซู ูุชู ุญุฐูู ููุฑุงู (`fs.unlinkSync`) ุจุนุฏ ุงูุชูุงุก ุงููุนุงูุฌุฉ.

### ุจ- "ุนูู ุงููุธุงู" ูุนุจูุฑูุฉ ุงููุนุงูุฌุฉ (`gameService.js`)

ูุฐุง ุงูููู ูุญุชูู ุนูู ุฃูู "ุงูุฃุณุฑุงุฑ ุงูุชูููุฉ" ูููุดุฑูุน:

#### 1. ุฎูุงุฑุฒููุฉ ุงูุชุณููุฉ (The Normalization Engine):
ููุงุฐุง ูู ูููุฉุ ูุฃู ุงููุณุชุฎุฏู ูุฏ ููุทู "ุฃููู" ูุงูุฐูุงุก ุงูุงุตุทูุงุนู ููุชุจูุง "ุงููู"ุ ุฃู ุงูุขูุฉ ููุชูุจุฉ ุจุฑุณู ุนุซูุงูู "ุณููููฐูููฐุช" ุจูููุง Whisper ููุทููุง "ุณูุงูุงุช".
*   **Unicode Mapping**: ูููู ุจุชุญููู `0670` (ุงูุฃูู ุงูุฎูุฌุฑูุฉ) ุฅูู ุฃูู ุนุงุฏูุฉ.
*   **Standardization**: ุชูุญูุฏ ุฌููุน ุฃุดูุงู ุงูููุฒุงุช (ุฃุ ุฅุ ุข) ุฅูู (ุง)ุ ูุงูุชุงุก ุงููุฑุจูุทุฉ (ุฉ) ุฅูู (ูู)ุ ูุงููุงุก (ู) ุฅูู (ู).
*   **Regex Cleaning**: ุญุฐู ูู ุนูุงูุงุช ุงูุชุดููู (ุงููุชุญุฉุ ุงูุถูุฉุ ุงููุณุฑุฉุ ุงูุชูููู) ุจุงุณุชุฎุฏุงู Regex `[\u064B-\u065F]`.
*   **Handled Exceptions**: ูููุง ุจุนูู "ูุงููุณ ุงุณุชุซูุงุกุงุช" ูููููุงุช ุงูุชู ุบุงูุจุงู ูุง ูุฎุทุฆ ูููุง ุงูู STT ูุซู (ุงูุฑุญูุงู -> ุงูุฑุญูู)ุ (ูุงุฐุง -> ูุฐุง).

#### 2. ุฎูุงุฑุฒููุฉ ุงูููุงุฑูุฉ (Levenshtein Distance):
ูุง ููุชูู ุจูุณุญ ุงููููุฉ (Strict match) ููุทุ ุจู ูุณุชุฎุฏู ุฎูุงุฑุฒููุฉ "ุงููุณุงูุฉ ุจูู ุงูุณูุงุณู ุงููุตูุฉ":
*   ุชุญุณุจ ุนุฏุฏ ุงูุชุนุฏููุงุช (ุญุฐูุ ุฅุถุงูุฉุ ุงุณุชุจุฏุงู) ุงููุทููุจุฉ ูุชุญููู ุฌููุฉ ุงููุณุชุฎุฏู ููุฌููุฉ ุงูุตุญูุญุฉ.
*   ุฅุฐุง ูุงูุช ูุณุจุฉ ุงูุชุดุงุจู (Similarity Ratio) ุฃูุจุฑ ูู **80%** ูููููุงุช ุงูุทูููุฉุ ุฃู **65%** ูููููุงุช ุงููุตูุฑุฉุ ูุนุชุจุฑ ุงูุฅุฌุงุจุฉ ุตุญูุญุฉ. ูุฐุง ูุนุงูุฌ ูุดููุฉ "ุงููุฏุบุงุช" ุฃู ุงูุฃุตูุงุช ุงููุญูุทุฉ.

#### 3. ูุธุงู ุงูุชุญููู ุงููุณุจู (Prefetching Strategy):
*   ูุณุชุฎุฏู `PREFETCH_THRESHOLD = 7`. ุนูุฏูุง ูุตู ุงููุณุชุฎุฏู ููุณุคุงู ุฑูู 7 ูู ุฃุตู 10ุ ูุจุฏุฃ ุงูุณูุฑูุฑ ููุฑุงู ูู ุชูููุฏ ุงูู 10 ุฃุณุฆูุฉ ุงููุงุฏูุฉ ูู ุงูุฎูููุฉ. 
*   ุจูุฐู ุงูุทุฑููุฉุ ุนูุฏูุง ูุถุบุท ุงููุณุชุฎุฏู ุนูู "ูุชุงุจุนุฉ"ุ ูุฌุฏ ุงูุฃุณุฆูุฉ ุฌุงูุฒุฉ ููุฑุงู ุฏูู ุงูุชุธุงุฑ AI ูุฑุฉ ุฃุฎุฑู (Latency Zero Experience).

### ุฌ- ุชูุงูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู (`aiService.js`)

#### 1. ููุฏุณุฉ ุงูุฃูุงูุฑ (Prompt Engineering):
*   ุงูุฃูุงูุฑ (Prompts) ููุชูุจุฉ ุฎุตูุตุงู ูุชุฌุจุฑ ุงูููุฏูู ุนูู ุฅุฎุฑุงุฌ **JSON ููุท**.
*   ูุทูุจ ููู ุงุฎุชูุงุฑ ุขูุฉ ูุงููุฉุ ุซู ูููุฉ "ููุตููุฉ" (Target Word) ูุฅุฎูุงุฆูุงุ ูุน ุงูุญูุงุธ ุนูู ุงูุชุดููู ูู ูุต ุงูุณุคุงู ูุณูููุฉ ุงููุฑุงุกุฉ.

#### 2. ุชูููุฉ ุงูู STT Priming:
ูุฐุง ูู ุฃูู ุฌุฒุก ุชููู. Whisper ูุฏ ููููุณ ุนูุฏ ุณูุงุน ูููุงุช ูุฑุขููุฉ ุบุฑูุจุฉ. 
*   **ุงูุญู**: ูููุง ุจุชุฒููุฏ Whisper ุจู `verseContext`. ูุฎุจุฑู: "ุงููุณุชุฎุฏู ููุฑุฃ ูุฐู ุงูุขูุฉ ุชุญุฏูุฏุงู". ูุฐุง ูุฌุนู ุงูููุฏูู "ูุชููุน" ุงููููุงุชุ ููุง ูุฑูุน ุงูุฏูุฉ ุฅูู ูุณุชููุงุช ูุฐููุฉ ุญุชู ูุน ูุฌูุฏ ุถูุถุงุก.

---

## 3. ุชูุงุตูู ุงูุฌุฒุก ุงูุฃูุงูู (Deep Frontend Logic)

### ุฃ- ุชุณุฌูู ุงูุตูุช (`Game.jsx`)
*   ูุณุชุฎุฏู **MediaRecorder API**. 
*   ูุทูุจ ุตูุงุญูุงุช ุงููููุฑูููู ุจุฎุตุงุฆุต ูุชูุฏูุฉ: `echoCancellation: true` (ูุฅูุบุงุก ุงูุตุฏู) ู `noiseSuppression: true` (ูุชูููู ุงูุถุฌูุฌ).
*   ูุชู ุชุญููู ุงูุตูุช ุฅูู ุตูุบุฉ `audio/webm` (ุฃู `audio/mp4` ุญุณุจ ุงููุชุตูุญ) ูุถูุงู ุงูุชูุงูู ูุน ููุฏูู Whisper.

### ุจ- ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู (UX Flow)
*   **Base64 Audio Feedback**: ุงูุณูุฑูุฑ ูุง ูุฑุณู ููู ุตูุชูุ ุจู ูุฑุณู "ูุตุงู ูุดูุฑุงู" (Base64). ูููู ุงููุฑููุช-ุฅูุฏ ุจุชุญูููู ููุฑุงู ุฅูู ุตูุช ูุณููุน ุจุงุณุชุฎุฏุงู `new Audio()`.
*   **Auto-Advance**: ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ุตุญูุญุฉุ ููุชูู ุงููุธุงู ุชููุงุฆูุงู ุจุนุฏ 3 ุซูุงููุ ููุง ูุนุทู ุฅุญุณุงุณุงู ุจุณูุงุณุฉ "ุงูุฃูุนุงุจ".

---

## 4. ุชุฏูู ุงูุจูุงูุงุช (Data Flow - ุงูุฎุทูุงุช ุจุงูุชุฑุชูุจ)

1.  **Start**: ุงููุณุชุฎุฏู ูุถุบุท "ุงุจุฏุฃ". ูุฑุณู ุงููุฑููุช ุฅูุฏ ุทูุจ ูู `/game/start`.
2.  **Generate**: ุงูุณูุฑูุฑ ูุฎุชุงุฑ ุณูุฑุฉ ุนุดูุงุฆูุฉุ ูุฑุณู ูุตูุง ูู GPT-4oุ ูุณุชูู 10 ุฃุณุฆูุฉุ ููุฎุฒู ุงูุฌูุณุฉ ูู ุงูุฐุงูุฑุฉ.
3.  **Record**: ุงููุณุชุฎุฏู ูุณุฌู ุตูุชู ููู ููุทู ุงููููุฉ ุงููุงูุตุฉ.
4.  **Analyze**: 
    *   ูุตู ุงูุตูุช ููุณูุฑูุฑ.
    *   ููุฑุณู ุงูุตูุช + ุณูุงู ุงูุขูุฉ ูู Groq Whisper.
    *   ูุชู ููุงุฑูุฉ ุงููุต ุงููุงุชุฌ ูุน ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุจุนุฏ "ุงูุชุณููุฉ" (Normalization).
5.  **Feedback**: 
    *   ุฅุฐุง ูุงู ุฎุทุฃุ ููุฑุณู ุงููุต ูู ElevenLabs ูุชูููุฏ ุตูุช ุชุตุญูุญู.
    *   ูุชู ุฅุฑุณุงู (ุงููุชูุฌุฉ + ุงูุตูุช + ุญุงูุฉ ุงูุชูุฏู) ูููุฑููุช ุฅูุฏ.
6.  **Loop**: ุชุณุชูุฑ ุงูุนูููุฉ ุญุชู ุงูุณุคุงู ุงูุณุงุจุนุ ุญูุซ ูุชู "ุงูุชุญููู ุงููุณุจู" ููุฃุณุฆูุฉ ุงููุงุฏูุฉ.

---

## 5. ููุฒุงุช ุจุฑูุฌูุฉ ูุชููุฒุฉ ููููุงุจูุฉ (Key Talking Points)

1.  **Scalability**: ุงููุธุงู ูุตูู ููุฏุนู ุฅุถุงูุฉ ุขูุงู ุงูุขูุงุช ุจุณูููุฉ ุนุจุฑ ููู `quran_data.json`.
2.  **Robustness**: ูุณุชุฎุฏู `try-catch blocks` ูู ูู ุงูุนูููุงุช ุงูุฎุงุฑุฌูุฉ ูุถูุงู ุนุฏู ุชููู ุงูุณูุฑูุฑ ูู ุญุงู ุชุนุทู ุฃุญุฏ ุงูู APIs.
3.  **Optimized Latency**: ุงุณุชุฎุฏุงู Groq ุจุฏูุงู ูู OpenAI ูุจุงุดุฑุฉ ููู ุฒูู ุงูุงุณุชุฌุงุจุฉ ูู 5 ุซูุงูู ุฅูู ุฃูู ูู ุซุงููุฉ ูุงุญุฏุฉ.
4.  **Memory Management**: ุฌูุณุงุช ุงููุนุจ ูุง ุชูุฎุฒู ูู ูุงุนุฏุฉ ุจูุงูุงุช ุจุทูุฆุฉุ ุจู ูู `Map` ุณุฑูุน ุฌุฏุงูุ ููุง ูุฌุนูู ูุซุงููุงู ููุชุทุจููุงุช "ุงูุญูุฉ" (Real-time).

---

## 6. ููุฎุต ุฃุฏูุงุฑ ุงููููุงุช:
*   `server.js`: ุงูุจูุงุจ ูุงูููุธู (Traffic Controller).
*   `gameService.js`: ุงููุงุถู ูุงููุญุฑู (Business Logic).
*   `aiService.js`: ุงููุชุฑุฌู ูุงููููุฑ (AI Brain).
*   `ttsService.js`: ุงููุชุญุฏุซ (Voice).
*   `App.jsx`: ุงููุฏูุฑ (State Manager).

---
**ุฃูุช ุงูุขู ุชููู ูู ุงูุชูุงุตูู. ุฑูุฒ ุนูู ุฃูู ููุชู ุจู "ุฏูุฉ ุงูุจูุงูุงุช" ู "ุณุฑุนุฉ ุงุณุชุฌุงุจุฉ ุงููุณุชุฎุฏู" (User Experience & Latency).**
